!function(g){g.fn.gpGallery=function(t,i){var s={is_first_big:!0,row_min_height:180,row_max_height:250,row_max_width:null,gutter:5};function c(i,t){var e=0;return i.length&&g.each(i,function(i,t){e+=t.width}),t&&(e+=t.width),e}return i&&g.extend(s,i),this.each(function(){var i=g(this),n=s.row_max_width||i.width(),a=[],r={items:[],width:0,height:0};i.find(t).each(function(){var i=g(this),t=i;if("IMG"!=t[0].nodeName.toUpperCase()?t=t.find("img"):i=g("<div>").insertBefore(t).append(t),t.length){i.css({width:"auto",float:"left",position:"relative"});var e={pic:t,container:i,original_height:t.height()||t.attr("height"),original_width:t.width()||t.attr("width")};e.aspect=e.original_width/e.original_height,e.scale=s.row_min_height/e.original_height,e.width=e.original_width*e.scale,e.height=e.original_height*e.scale;var h=c(r.items,e);n<h&&(a.push(r),r={items:[],width:0,height:0}),r.items.push(e)}}),r.last=!0,a.push(r),g.each(a,function(i,e){var h;e.last||(e.scale=(n-(e.items.length-1)*s.gutter)/c(e.items)),g.each(e.items,function(i,t){e.scale&&(t.width=t.width*e.scale,t.height=t.height*e.scale);t.pic,t.container;(h=t).container.css({height:t.height+"px",width:t.width+"px",marginTop:s.gutter+"px"}),0<i?t.container.css({marginLeft:s.gutter+"px"}):t.container.css({clear:"left"})}),h&&(h.width=h.width+n-c(e.items),h.pic.css({width:h.width+"px"}))})})}}(jQuery);